import nmap

# Read IP addresses from file
with open('ip.txt', 'r') as file:
    ips = [line.strip() for line in file if line.strip()]

# Define port range
start_port = 1
end_port = 1024
port_range = f"{start_port}-{end_port}"

# Create scanner
nm = nmap.PortScanner()

# Loop through IPs
for ip in ips:
    nm.scan(ip, port_range)

    if ip in nm.all_hosts() and nm[ip].state() == 'up':
        for port in range(start_port, end_port + 1):
            if 'tcp' in nm[ip] and port in nm[ip]['tcp']:
                state = nm[ip]['tcp'][port]['state']
            else:
                state = 'closed'
            print(f"{ip} port {port} {state}")
    else:
        print(f"IP {ip} not reachable")
