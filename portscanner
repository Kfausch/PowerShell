import nmap

# Read IP addresses from file
with open('ip.txt', 'r') as file:
    ips = [line.strip() for line in file if line.strip()]

# Port range as variable (change this to adjust)
port_range = '1-1024'

# Parse port range
start_port, end_port = map(int, port_range.split('-'))

# Create scanner
nm = nmap.PortScanner()

# Loop through IPs
for ip in ips:
    nm.scan(ip, port_range)
    
    if ip in nm and nm[ip].state() == 'up':
        for port in range(start_port, end_port + 1):
            if 'tcp' in nm[ip] and port in nm[ip]['tcp']:
                state = nm[ip]['tcp'][port]['state']
            else:
                state = 'closed'
            print(f"IP {ip} - port {port} - state {state}")
    else:
        print(f"IP {ip} not reachable")
